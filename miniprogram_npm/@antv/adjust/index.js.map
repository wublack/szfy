{"version":3,"sources":["adjust.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\r\n\tif(typeof exports === 'object' && typeof module === 'object')\r\n\t\tmodule.exports = factory();\r\n\telse if(typeof define === 'function' && define.amd)\r\n\t\tdefine([], factory);\r\n\telse if(typeof exports === 'object')\r\n\t\texports[\"adjust\"] = factory();\r\n\telse\r\n\t\troot[\"adjust\"] = factory();\r\n})(typeof self !== 'undefined' ? self : this, function() {\r\nreturn /******/ (function(modules) { // webpackBootstrap\r\n/******/ \t// The module cache\r\n/******/ \tvar installedModules = {};\r\n/******/\r\n/******/ \t// The require function\r\n/******/ \tfunction __webpack_require__(moduleId) {\r\n/******/\r\n/******/ \t\t// Check if module is in cache\r\n/******/ \t\tif(installedModules[moduleId]) {\r\n/******/ \t\t\treturn installedModules[moduleId].exports;\r\n/******/ \t\t}\r\n/******/ \t\t// Create a new module (and put it into the cache)\r\n/******/ \t\tvar module = installedModules[moduleId] = {\r\n/******/ \t\t\ti: moduleId,\r\n/******/ \t\t\tl: false,\r\n/******/ \t\t\texports: {}\r\n/******/ \t\t};\r\n/******/\r\n/******/ \t\t// Execute the module function\r\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\r\n/******/\r\n/******/ \t\t// Flag the module as loaded\r\n/******/ \t\tmodule.l = true;\r\n/******/\r\n/******/ \t\t// Return the exports of the module\r\n/******/ \t\treturn module.exports;\r\n/******/ \t}\r\n/******/\r\n/******/\r\n/******/ \t// expose the modules object (__webpack_modules__)\r\n/******/ \t__webpack_require__.m = modules;\r\n/******/\r\n/******/ \t// expose the module cache\r\n/******/ \t__webpack_require__.c = installedModules;\r\n/******/\r\n/******/ \t// define getter function for harmony exports\r\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\r\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\r\n/******/ \t\t\tObject.defineProperty(exports, name, {\r\n/******/ \t\t\t\tconfigurable: false,\r\n/******/ \t\t\t\tenumerable: true,\r\n/******/ \t\t\t\tget: getter\r\n/******/ \t\t\t});\r\n/******/ \t\t}\r\n/******/ \t};\r\n/******/\r\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\r\n/******/ \t__webpack_require__.n = function(module) {\r\n/******/ \t\tvar getter = module && module.__esModule ?\r\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\r\n/******/ \t\t\tfunction getModuleExports() { return module; };\r\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\r\n/******/ \t\treturn getter;\r\n/******/ \t};\r\n/******/\r\n/******/ \t// Object.prototype.hasOwnProperty.call\r\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\r\n/******/\r\n/******/ \t// __webpack_public_path__\r\n/******/ \t__webpack_require__.p = \"\";\r\n/******/\r\n/******/ \t// Load entry module and return exports\r\n/******/ \treturn __webpack_require__(__webpack_require__.s = 10);\r\n/******/ })\r\n/************************************************************************/\r\n/******/ ([\r\n/* 0 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nvar isObject = __webpack_require__(12);\r\n\r\nvar isArray = __webpack_require__(1);\r\n\r\nvar each = function each(elements, func) {\r\n  if (!elements) {\r\n    return;\r\n  }\r\n\r\n  var rst = void 0;\r\n\r\n  if (isArray(elements)) {\r\n    for (var i = 0, len = elements.length; i < len; i++) {\r\n      rst = func(elements[i], i);\r\n\r\n      if (rst === false) {\r\n        break;\r\n      }\r\n    }\r\n  } else if (isObject(elements)) {\r\n    for (var k in elements) {\r\n      if (elements.hasOwnProperty(k)) {\r\n        rst = func(elements[k], k);\r\n\r\n        if (rst === false) {\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = each;\r\n\r\n/***/ }),\r\n/* 1 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nvar isType = __webpack_require__(5);\r\n\r\nvar isArray = Array.isArray ? Array.isArray : function (value) {\r\n  return isType(value, 'Array');\r\n};\r\nmodule.exports = isArray;\r\n\r\n/***/ }),\r\n/* 2 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nvar mix = __webpack_require__(3);\r\n\r\nvar Adjust =\r\n/*#__PURE__*/\r\nfunction () {\r\n  var _proto = Adjust.prototype;\r\n\r\n  _proto._initDefaultCfg = function _initDefaultCfg() {\r\n    this.adjustNames = ['x', 'y']; // 调整的维度，默认,x,y都做调整\r\n  };\r\n\r\n  function Adjust(cfg) {\r\n    this._initDefaultCfg();\r\n\r\n    mix(this, cfg);\r\n  }\r\n  /**\r\n   * @override\r\n   */\r\n\r\n\r\n  _proto.processAdjust = function processAdjust()\r\n  /* dataArray */\r\n  {};\r\n\r\n  return Adjust;\r\n}();\r\n\r\nmodule.exports = Adjust;\r\n\r\n/***/ }),\r\n/* 3 */\r\n/***/ (function(module, exports) {\r\n\r\nfunction _mix(dist, obj) {\r\n  for (var key in obj) {\r\n    if (obj.hasOwnProperty(key) && key !== 'constructor' && obj[key] !== undefined) {\r\n      dist[key] = obj[key];\r\n    }\r\n  }\r\n}\r\n\r\nvar mix = function mix(dist, src1, src2, src3) {\r\n  if (src1) _mix(dist, src1);\r\n  if (src2) _mix(dist, src2);\r\n  if (src3) _mix(dist, src3);\r\n  return dist;\r\n};\r\n\r\nmodule.exports = mix;\r\n\r\n/***/ }),\r\n/* 4 */\r\n/***/ (function(module, exports) {\r\n\r\nvar merge = function merge(dataArray) {\r\n  var rst = [];\r\n\r\n  for (var i = 0; i < dataArray.length; i++) {\r\n    rst = rst.concat(dataArray[i]);\r\n  }\r\n\r\n  return rst;\r\n};\r\n\r\nmodule.exports = merge;\r\n\r\n/***/ }),\r\n/* 5 */\r\n/***/ (function(module, exports) {\r\n\r\nvar toString = {}.toString;\r\n\r\nvar isType = function isType(value, type) {\r\n  return toString.call(value) === '[object ' + type + ']';\r\n};\r\n\r\nmodule.exports = isType;\r\n\r\n/***/ }),\r\n/* 6 */\r\n/***/ (function(module, exports) {\r\n\r\n// isFinite,\r\nvar isNil = function isNil(value) {\r\n  /**\r\n   * isNil(null) => true\r\n   * isNil() => true\r\n   */\r\n  return value === null || value === undefined;\r\n};\r\n\r\nmodule.exports = isNil;\r\n\r\n/***/ }),\r\n/* 7 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nvar DEFAULT_Y = 0; // 默认的y的值\r\n\r\nvar each = __webpack_require__(0);\r\n\r\nvar ArrayUtil = {\r\n  values: __webpack_require__(8)\r\n};\r\nmodule.exports = {\r\n  /**\r\n   * 对应的维度是否可以调整\r\n   * @protected\r\n   * @param  {String}  dimName 可以调整的维度 x,y\r\n   * @return {Boolean} 是否可以调整\r\n   */\r\n  isAdjust: function isAdjust(dimName) {\r\n    return this.adjustNames.indexOf(dimName) >= 0;\r\n  },\r\n\r\n  /**\r\n   * @protected\r\n   * 获取可调整度量对应的值\r\n   * @param  {Frame} mergeData 数据\r\n   * @return {Object} 值的映射\r\n   */\r\n  _getDimValues: function _getDimValues(mergeData) {\r\n    var self = this;\r\n    var valuesMap = {};\r\n    var dims = [];\r\n\r\n    if (self.xField && self.isAdjust('x')) {\r\n      dims.push(self.xField);\r\n    }\r\n\r\n    if (self.yField && self.isAdjust('y')) {\r\n      dims.push(self.yField);\r\n    }\r\n\r\n    each(dims, function (dim) {\r\n      var values = ArrayUtil.values(mergeData, dim);\r\n      values.sort(function (v1, v2) {\r\n        return v1 - v2;\r\n      });\r\n      valuesMap[dim] = values;\r\n    });\r\n\r\n    if (!self.yField && self.isAdjust('y')) {\r\n      // 只有一维的情况下,同时调整y\r\n      var dim = 'y';\r\n      var values = [DEFAULT_Y, 1]; // 默认分布在y轴的 0.1 与 0.2 之间\r\n\r\n      valuesMap[dim] = values;\r\n    }\r\n\r\n    return valuesMap;\r\n  },\r\n  adjustData: function adjustData(dataArray, mergeData) {\r\n    var self = this;\r\n\r\n    var valuesMap = self._getDimValues(mergeData);\r\n\r\n    each(dataArray, function (data, index) {\r\n      // 遍历所有数据集合\r\n      each(valuesMap, function (values, dim) {\r\n        // 根据不同的度量分别调整位置\r\n        self.adjustDim(dim, values, data, dataArray.length, index);\r\n      });\r\n    });\r\n  },\r\n  getAdjustRange: function getAdjustRange(dim, key, values) {\r\n    var self = this;\r\n    var index = values.indexOf(key);\r\n    var length = values.length;\r\n    var pre;\r\n    var next;\r\n\r\n    if (!self.yField && self.isAdjust('y')) {\r\n      pre = 0;\r\n      next = 1;\r\n    } else if (length > 1) {\r\n      pre = index === 0 ? values[0] : values[index - 1];\r\n      next = index === length - 1 ? values[length - 1] : values[index + 1];\r\n\r\n      if (index !== 0) {\r\n        pre += (key - pre) / 2;\r\n      } else {\r\n        pre -= (next - key) / 2;\r\n      }\r\n\r\n      if (index !== length - 1) {\r\n        next -= (next - key) / 2;\r\n      } else {\r\n        next += (key - values[length - 2]) / 2;\r\n      }\r\n    } else {\r\n      pre = key === 0 ? 0 : key - 0.5;\r\n      next = key === 0 ? 1 : key + 0.5;\r\n    }\r\n\r\n    return {\r\n      pre: pre,\r\n      next: next\r\n    };\r\n  },\r\n\r\n  /**\r\n   * 对数据进行分组\r\n   * @param  {Array} data 数据\r\n   * @param  {String} dim 分组的字段\r\n   * @return {Object}  分组的键值对映射\r\n   */\r\n  groupData: function groupData(data, dim) {\r\n    var groups = {};\r\n    each(data, function (record) {\r\n      var value = record[dim];\r\n\r\n      if (value === undefined) {\r\n        value = record[dim] = DEFAULT_Y;\r\n      }\r\n\r\n      if (!groups[value]) {\r\n        groups[value] = [];\r\n      }\r\n\r\n      groups[value].push(record);\r\n    });\r\n    return groups;\r\n  }\r\n};\r\n\r\n/***/ }),\r\n/* 8 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nvar isNil = __webpack_require__(6);\r\n\r\nvar isArray = __webpack_require__(1);\r\n\r\nvar each = __webpack_require__(0);\r\n\r\nmodule.exports = function valuesOfKey(data, name) {\r\n  var rst = [];\r\n  var tmpMap = {};\r\n\r\n  for (var i = 0; i < data.length; i++) {\r\n    var obj = data[i];\r\n    var value = obj[name];\r\n\r\n    if (!isNil(value)) {\r\n      if (!isArray(value)) {\r\n        value = [value];\r\n      }\r\n\r\n      each(value, function (val) {\r\n        if (!tmpMap[val]) {\r\n          rst.push(val);\r\n          tmpMap[val] = true;\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  return rst;\r\n};\r\n\r\n/***/ }),\r\n/* 9 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\n/**\r\n * 是否为函数\r\n * @param  {*} fn 对象\r\n * @return {Boolean}  是否函数\r\n */\r\nvar isType = __webpack_require__(5);\r\n\r\nvar isFunction = function isFunction(value) {\r\n  return isType(value, 'Function');\r\n};\r\n\r\nmodule.exports = isFunction;\r\n\r\n/***/ }),\r\n/* 10 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\n// 完整版下使用支持按照某个字段进行分组的 dodge\r\nvar mix = __webpack_require__(3);\r\n\r\nvar Adjust = __webpack_require__(2);\r\n\r\nvar Dodge = __webpack_require__(11);\r\n\r\nvar Stack = __webpack_require__(13);\r\n\r\nvar AdjustMixin = __webpack_require__(7);\r\n\r\nvar DodgeMixin = __webpack_require__(14);\r\n\r\nvar StackMixin = __webpack_require__(18);\r\n\r\nmix(Adjust.prototype, AdjustMixin);\r\nmix(Dodge.prototype, AdjustMixin, DodgeMixin);\r\nmix(Stack.prototype, StackMixin);\r\nAdjust.Jitter = __webpack_require__(19);\r\nAdjust.Symmetric = __webpack_require__(20);\r\nAdjust.Dodge = Dodge;\r\nAdjust.Stack = Stack;\r\nmodule.exports = Adjust;\r\n\r\n/***/ }),\r\n/* 11 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\r\n\r\nvar Adjust = __webpack_require__(2);\r\n\r\nvar each = __webpack_require__(0);\r\n\r\nvar MARGIN_RATIO = 1 / 2;\r\nvar DODGE_RATIO = 1 / 2;\r\n\r\nvar Dodge =\r\n/*#__PURE__*/\r\nfunction (_Adjust) {\r\n  _inheritsLoose(Dodge, _Adjust);\r\n\r\n  function Dodge() {\r\n    return _Adjust.apply(this, arguments) || this;\r\n  }\r\n\r\n  var _proto = Dodge.prototype;\r\n\r\n  _proto._initDefaultCfg = function _initDefaultCfg() {\r\n    /**\r\n     * 调整过程中,2个数据的间距\r\n     * @type {Number}\r\n     */\r\n    this.marginRatio = MARGIN_RATIO;\r\n    /**\r\n     * 调整占单位宽度的比例,例如：占2个分类间距的 1/2\r\n     * @type {Number}\r\n     */\r\n\r\n    this.dodgeRatio = DODGE_RATIO;\r\n    this.adjustNames = ['x', 'y']; // 调整的维度，默认,x,y都做调整\r\n  };\r\n\r\n  _proto.getDodgeOffset = function getDodgeOffset(range, index, count) {\r\n    var self = this;\r\n    var pre = range.pre;\r\n    var next = range.next;\r\n    var tickLength = next - pre;\r\n    var width = tickLength * self.dodgeRatio / count;\r\n    var margin = self.marginRatio * width;\r\n    var offset = 1 / 2 * (tickLength - count * width - (count - 1) * margin) + ((index + 1) * width + index * margin) - 1 / 2 * width - 1 / 2 * tickLength;\r\n    return (pre + next) / 2 + offset;\r\n  };\r\n\r\n  _proto.processAdjust = function processAdjust(dataArray) {\r\n    var self = this;\r\n    var count = dataArray.length;\r\n    var xField = self.xField;\r\n    each(dataArray, function (data, index) {\r\n      for (var i = 0, len = data.length; i < len; i++) {\r\n        var obj = data[i];\r\n        var value = obj[xField];\r\n        var range = {\r\n          pre: len === 1 ? value - 1 : value - 0.5,\r\n          next: len === 1 ? value + 1 : value + 0.5\r\n        };\r\n        var dodgeValue = self.getDodgeOffset(range, index, count);\r\n        obj[xField] = dodgeValue;\r\n      }\r\n    });\r\n  };\r\n\r\n  return Dodge;\r\n}(Adjust);\r\n\r\nAdjust.Dodge = Dodge;\r\nmodule.exports = Dodge;\r\n\r\n/***/ }),\r\n/* 12 */\r\n/***/ (function(module, exports) {\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\r\n  return typeof obj;\r\n} : function (obj) {\r\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\r\n};\r\n\r\nvar isObject = function isObject(value) {\r\n  /**\r\n   * isObject({}) => true\r\n   * isObject([1, 2, 3]) => true\r\n   * isObject(Function) => true\r\n   * isObject(null) => false\r\n   */\r\n  var type = typeof value === 'undefined' ? 'undefined' : _typeof(value);\r\n  return value !== null && type === 'object' || type === 'function';\r\n};\r\n\r\nmodule.exports = isObject;\r\n\r\n/***/ }),\r\n/* 13 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\r\n\r\nvar isArray = __webpack_require__(1);\r\n\r\nvar isNil = __webpack_require__(6);\r\n\r\nvar Adjust = __webpack_require__(2);\r\n\r\nvar Stack =\r\n/*#__PURE__*/\r\nfunction (_Adjust) {\r\n  _inheritsLoose(Stack, _Adjust);\r\n\r\n  function Stack() {\r\n    return _Adjust.apply(this, arguments) || this;\r\n  }\r\n\r\n  var _proto = Stack.prototype;\r\n\r\n  _proto._initDefaultCfg = function _initDefaultCfg() {\r\n    this.xField = null; // 调整对应的 x 方向对应的字段名称\r\n\r\n    this.yField = null; // 调整对应的 y 方向对应的字段名称\r\n  };\r\n\r\n  _proto.processAdjust = function processAdjust(dataArray) {\r\n    this.processStack(dataArray);\r\n  };\r\n\r\n  _proto.processStack = function processStack(dataArray) {\r\n    var self = this;\r\n    var xField = self.xField;\r\n    var yField = self.yField;\r\n    var count = dataArray.length;\r\n    var stackCache = {\r\n      positive: {},\r\n      negative: {}\r\n    }; // 层叠顺序翻转\r\n\r\n    if (self.reverseOrder) {\r\n      dataArray = dataArray.slice(0).reverse();\r\n    }\r\n\r\n    for (var i = 0; i < count; i++) {\r\n      var data = dataArray[i];\r\n\r\n      for (var j = 0, len = data.length; j < len; j++) {\r\n        var item = data[j];\r\n        var x = item[xField] || 0;\r\n        var y = item[yField];\r\n        var xkey = x.toString();\r\n        y = isArray(y) ? y[1] : y;\r\n\r\n        if (!isNil(y)) {\r\n          var direction = y >= 0 ? 'positive' : 'negative';\r\n\r\n          if (!stackCache[direction][xkey]) {\r\n            stackCache[direction][xkey] = 0;\r\n          }\r\n\r\n          item[yField] = [stackCache[direction][xkey], y + stackCache[direction][xkey]];\r\n          stackCache[direction][xkey] += y;\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  return Stack;\r\n}(Adjust);\r\n\r\nAdjust.Stack = Stack;\r\nmodule.exports = Stack;\r\n\r\n/***/ }),\r\n/* 14 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nvar ArrayUtil = {\r\n  merge: __webpack_require__(4),\r\n  values: __webpack_require__(8)\r\n};\r\n\r\nvar group = __webpack_require__(15);\r\n\r\nvar each = __webpack_require__(0);\r\n\r\nmodule.exports = {\r\n  /**\r\n   * @protected\r\n   * @override\r\n   */\r\n  processAdjust: function processAdjust(dataArray) {\r\n    var self = this;\r\n    var mergeData = ArrayUtil.merge(dataArray);\r\n    var dodgeDim = self.dodgeBy;\r\n    var adjDataArray = dataArray;\r\n\r\n    if (dodgeDim) {\r\n      // 如果指定了分组dim的字段\r\n      adjDataArray = group(mergeData, dodgeDim);\r\n    }\r\n\r\n    self.cacheMap = {};\r\n    self.adjDataArray = adjDataArray;\r\n    self.mergeData = mergeData;\r\n    self.adjustData(adjDataArray, mergeData);\r\n    self.adjDataArray = null;\r\n    self.mergeData = null;\r\n  },\r\n  getDistribution: function getDistribution(dim) {\r\n    var self = this;\r\n    var dataArray = self.adjDataArray;\r\n    var cacheMap = self.cacheMap;\r\n    var map = cacheMap[dim];\r\n\r\n    if (!map) {\r\n      map = {};\r\n      each(dataArray, function (data, index) {\r\n        var values = ArrayUtil.values(data, dim);\r\n\r\n        if (!values.length) {\r\n          values.push(0);\r\n        }\r\n\r\n        each(values, function (val) {\r\n          if (!map[val]) {\r\n            map[val] = [];\r\n          }\r\n\r\n          map[val].push(index);\r\n        });\r\n      });\r\n      cacheMap[dim] = map;\r\n    }\r\n\r\n    return map;\r\n  },\r\n  adjustDim: function adjustDim(dim, values, data, frameCount, frameIndex) {\r\n    var self = this;\r\n    var map = self.getDistribution(dim);\r\n    var groupData = self.groupData(data, dim); // 根据值分组\r\n\r\n    each(groupData, function (group, key) {\r\n      key = parseFloat(key);\r\n      var range;\r\n\r\n      if (values.length === 1) {\r\n        range = {\r\n          pre: values[0] - 1,\r\n          next: values[0] + 1\r\n        };\r\n      } else {\r\n        range = self.getAdjustRange(dim, key, values);\r\n      }\r\n\r\n      each(group, function (record) {\r\n        var value = record[dim];\r\n        var valueArr = map[value];\r\n        var valIndex = valueArr.indexOf(frameIndex);\r\n        record[dim] = self.getDodgeOffset(range, valIndex, valueArr.length);\r\n      });\r\n    });\r\n  }\r\n};\r\n\r\n/***/ }),\r\n/* 15 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nvar groupToMap = __webpack_require__(16);\r\n\r\nvar group = function group(data, condition) {\r\n  if (!condition) {\r\n    return [data];\r\n  }\r\n\r\n  var groups = groupToMap(data, condition);\r\n  var array = [];\r\n\r\n  for (var i in groups) {\r\n    array.push(groups[i]);\r\n  }\r\n\r\n  return array;\r\n};\r\n\r\nmodule.exports = group;\r\n\r\n/***/ }),\r\n/* 16 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nvar isFunction = __webpack_require__(9);\r\n\r\nvar isArray = __webpack_require__(1);\r\n\r\nvar groupBy = __webpack_require__(17);\r\n\r\nvar groupToMap = function groupToMap(data, condition) {\r\n  if (!condition) {\r\n    return {\r\n      0: data\r\n    };\r\n  }\r\n\r\n  if (!isFunction(condition)) {\r\n    var paramsCondition = isArray(condition) ? condition : condition.replace(/\\s+/g, '').split('*');\r\n\r\n    condition = function condition(row) {\r\n      var unique = '_'; // 避免出现数字作为Key的情况，会进行按照数字的排序\r\n\r\n      for (var i = 0, l = paramsCondition.length; i < l; i++) {\r\n        unique += row[paramsCondition[i]] && row[paramsCondition[i]].toString();\r\n      }\r\n\r\n      return unique;\r\n    };\r\n  }\r\n\r\n  var groups = groupBy(data, condition);\r\n  return groups;\r\n};\r\n\r\nmodule.exports = groupToMap;\r\n\r\n/***/ }),\r\n/* 17 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nvar each = __webpack_require__(0);\r\n\r\nvar isArray = __webpack_require__(1);\r\n\r\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\r\n\r\nvar groupBy = function groupBy(data, condition) {\r\n  if (!condition || !isArray(data)) {\r\n    return data;\r\n  }\r\n\r\n  var result = {};\r\n  var key = null;\r\n  each(data, function (item) {\r\n    key = condition(item);\r\n\r\n    if (hasOwnProperty.call(result, key)) {\r\n      result[key].push(item);\r\n    } else {\r\n      result[key] = [item];\r\n    }\r\n  });\r\n  return result;\r\n};\r\n\r\nmodule.exports = groupBy;\r\n\r\n/***/ }),\r\n/* 18 */\r\n/***/ (function(module, exports) {\r\n\r\nmodule.exports = {\r\n  _initDefaultCfg: function _initDefaultCfg() {\r\n    this.xField = null; // 调整对应的 x 方向对应的字段名称\r\n\r\n    this.yField = null; // 调整对应的 y 方向对应的字段名称\r\n\r\n    this.height = null; // 仅有一个维度调整时，总的高度\r\n\r\n    this.size = 10; // 单个点的大小\r\n\r\n    this.reverseOrder = false; // 是否反序进行层叠\r\n\r\n    this.adjustNames = ['y']; // Only support stack y\r\n  },\r\n  processOneDimStack: function processOneDimStack(dataArray) {\r\n    var self = this;\r\n    var xField = self.xField;\r\n    var yField = self.yField || 'y';\r\n    var height = self.height;\r\n    var stackY = {}; // 如果层叠的顺序翻转\r\n\r\n    if (self.reverseOrder) {\r\n      dataArray = dataArray.slice(0).reverse();\r\n    }\r\n\r\n    for (var i = 0, len = dataArray.length; i < len; i++) {\r\n      var data = dataArray[i]; // cates\r\n\r\n      for (var j = 0, dataLen = data.length; j < dataLen; j++) {\r\n        var item = data[j];\r\n        var size = item.size || self.size;\r\n        var stackHeight = size * 2 / height;\r\n        var x = item[xField];\r\n\r\n        if (!stackY[x]) {\r\n          stackY[x] = stackHeight / 2;\r\n        }\r\n\r\n        item[yField] = stackY[x];\r\n        stackY[x] += stackHeight;\r\n      }\r\n    }\r\n  },\r\n  processAdjust: function processAdjust(dataArray) {\r\n    if (this.yField) {\r\n      this.processStack(dataArray);\r\n    } else {\r\n      this.processOneDimStack(dataArray);\r\n    }\r\n  }\r\n};\r\n\r\n/***/ }),\r\n/* 19 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\r\n\r\nvar each = __webpack_require__(0);\r\n\r\nvar mix = __webpack_require__(3);\r\n\r\nvar ArrayUtil = {\r\n  merge: __webpack_require__(4)\r\n};\r\n\r\nvar Adjust = __webpack_require__(2);\r\n\r\nvar AdjustMixin = __webpack_require__(7);\r\n\r\nvar Jitter =\r\n/*#__PURE__*/\r\nfunction (_Adjust) {\r\n  _inheritsLoose(Jitter, _Adjust);\r\n\r\n  function Jitter() {\r\n    return _Adjust.apply(this, arguments) || this;\r\n  }\r\n\r\n  var _proto = Jitter.prototype;\r\n\r\n  _proto._initDefaultCfg = function _initDefaultCfg() {\r\n    this.xField = null; // 调整对应的 x 方向对应的字段名称\r\n\r\n    this.yField = null; // 调整对应的 y 方向对应的字段名称\r\n\r\n    this.adjustNames = ['x', 'y']; // 指x,y\r\n\r\n    this.groupFields = null; // 参与分组的数据维度\r\n  };\r\n\r\n  _proto.processAdjust = function processAdjust(dataArray) {\r\n    var self = this;\r\n    var mergeData = ArrayUtil.merge(dataArray);\r\n    self.adjDataArray = dataArray;\r\n    self.mergeData = mergeData;\r\n    self.adjustData(dataArray, mergeData);\r\n    self.adjFrames = null;\r\n    self.mergeData = null;\r\n  };\r\n\r\n  _proto.getAdjustOffset = function getAdjustOffset(pre, next) {\r\n    var r = Math.random(); // 随机位置，均匀分布\r\n\r\n    var avg = next - pre; // * length\r\n\r\n    var append = avg * 0.05;\r\n    return pre + append + avg * 0.9 * r;\r\n  }; // adjust group data\r\n\r\n\r\n  _proto._adjustGroup = function _adjustGroup(group, dim, key, values) {\r\n    var self = this;\r\n    var range = self.getAdjustRange(dim, key, values);\r\n    each(group, function (record) {\r\n      record[dim] = self.getAdjustOffset(range.pre, range.next); // 获取调整的位置\r\n    });\r\n  };\r\n\r\n  _proto.adjustDim = function adjustDim(dim, values, data) {\r\n    var self = this;\r\n    var groupData = self.groupData(data, dim);\r\n    each(groupData, function (group, key) {\r\n      key = parseFloat(key);\r\n\r\n      self._adjustGroup(group, dim, key, values);\r\n    });\r\n  };\r\n\r\n  return Jitter;\r\n}(Adjust);\r\n\r\nmix(Jitter.prototype, AdjustMixin);\r\nAdjust.Jitter = Jitter;\r\nmodule.exports = Jitter;\r\n\r\n/***/ }),\r\n/* 20 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\r\n\r\nvar each = __webpack_require__(0);\r\n\r\nvar maxBy = __webpack_require__(21);\r\n\r\nvar isArray = __webpack_require__(1);\r\n\r\nvar ArrayUtil = {\r\n  merge: __webpack_require__(4)\r\n};\r\n\r\nvar Adjust = __webpack_require__(2);\r\n\r\nvar Symmetric =\r\n/*#__PURE__*/\r\nfunction (_Adjust) {\r\n  _inheritsLoose(Symmetric, _Adjust);\r\n\r\n  function Symmetric() {\r\n    return _Adjust.apply(this, arguments) || this;\r\n  }\r\n\r\n  var _proto = Symmetric.prototype;\r\n\r\n  _proto._initDefaultCfg = function _initDefaultCfg() {\r\n    this.xField = null; // 调整对应的 x 方向对应的字段名称\r\n\r\n    this.yField = null; // 调整对应的 y 方向对应的字段名称\r\n\r\n    this.cacheMax = null; // 缓存的最大值\r\n\r\n    this.adjustNames = ['y']; // Only support stack y\r\n\r\n    this.groupFields = null; // 参与分组的数据维度\r\n  }; // 获取最大的y值\r\n\r\n\r\n  _proto._getMax = function _getMax(dim) {\r\n    var self = this;\r\n    var mergeData = self.mergeData;\r\n    var maxRecord = maxBy(mergeData, function (obj) {\r\n      var value = obj[dim];\r\n\r\n      if (isArray(value)) {\r\n        return Math.max.apply(null, value);\r\n      }\r\n\r\n      return value;\r\n    });\r\n    var maxValue = maxRecord[dim];\r\n    var max = isArray(maxValue) ? Math.max.apply(null, maxValue) : maxValue;\r\n    return max;\r\n  }; // 获取每个字段最大的值\r\n\r\n\r\n  _proto._getXValuesMax = function _getXValuesMax() {\r\n    var self = this;\r\n    var yField = self.yField;\r\n    var xField = self.xField;\r\n    var cache = {};\r\n    var mergeData = self.mergeData;\r\n    each(mergeData, function (obj) {\r\n      var xValue = obj[xField];\r\n      var yValue = obj[yField];\r\n      var max = isArray(yValue) ? Math.max.apply(null, yValue) : yValue;\r\n      cache[xValue] = cache[xValue] || 0;\r\n\r\n      if (cache[xValue] < max) {\r\n        cache[xValue] = max;\r\n      }\r\n    });\r\n    return cache;\r\n  }; // 入口函数\r\n\r\n\r\n  _proto.processAdjust = function processAdjust(dataArray) {\r\n    var self = this;\r\n    var mergeData = ArrayUtil.merge(dataArray);\r\n    self.mergeData = mergeData;\r\n\r\n    self._processSymmetric(dataArray);\r\n\r\n    self.mergeData = null;\r\n  }; // 处理对称\r\n\r\n\r\n  _proto._processSymmetric = function _processSymmetric(dataArray) {\r\n    var self = this;\r\n    var xField = self.xField;\r\n    var yField = self.yField;\r\n\r\n    var max = self._getMax(yField);\r\n\r\n    var first = dataArray[0][0];\r\n    var cache;\r\n\r\n    if (first && isArray(first[yField])) {\r\n      cache = self._getXValuesMax();\r\n    }\r\n\r\n    each(dataArray, function (data) {\r\n      each(data, function (obj) {\r\n        var value = obj[yField];\r\n        var offset;\r\n\r\n        if (isArray(value)) {\r\n          var xValue = obj[xField];\r\n          var valueMax = cache[xValue];\r\n          offset = (max - valueMax) / 2;\r\n          var tmp = [];\r\n          /* eslint-disable no-loop-func */\r\n\r\n          each(value, function (subVal) {\r\n            // 多个字段\r\n            tmp.push(offset + subVal);\r\n          });\r\n          /* eslint-enable no-loop-func */\r\n\r\n          obj[yField] = tmp;\r\n        } else {\r\n          offset = (max - value) / 2;\r\n          obj[yField] = [offset, value + offset];\r\n        }\r\n      });\r\n    });\r\n  };\r\n\r\n  return Symmetric;\r\n}(Adjust);\r\n\r\nAdjust.Symmetric = Symmetric;\r\nmodule.exports = Symmetric;\r\n\r\n/***/ }),\r\n/* 21 */\r\n/***/ (function(module, exports, __webpack_require__) {\r\n\r\nvar isArray = __webpack_require__(1);\r\n\r\nvar isFunction = __webpack_require__(9);\r\n\r\nvar each = __webpack_require__(0);\r\n/**\r\n * @param {Array} arr The array to iterate over.\r\n * @param {Function} [fn] The iteratee invoked per element.\r\n * @return {*} Returns the maximum value.\r\n * @example\r\n *\r\n * var objects = [{ 'n': 1 }, { 'n': 2 }];\r\n *\r\n * maxBy(objects, function(o) { return o.n; });\r\n * // => { 'n': 2 }\r\n *\r\n * maxBy(objects, 'n');\r\n * // => { 'n': 2 }\r\n */\r\n\r\n\r\nvar maxBy = function maxBy(arr, fn) {\r\n  if (!isArray(arr)) {\r\n    return undefined;\r\n  }\r\n\r\n  var max = arr[0];\r\n  var maxData = void 0;\r\n\r\n  if (isFunction(fn)) {\r\n    maxData = fn(arr[0]);\r\n  } else {\r\n    maxData = arr[0][fn];\r\n  }\r\n\r\n  var data = void 0;\r\n  each(arr, function (val) {\r\n    if (isFunction(fn)) {\r\n      data = fn(val);\r\n    } else {\r\n      data = val[fn];\r\n    }\r\n\r\n    if (data > maxData) {\r\n      max = val;\r\n      maxData = data;\r\n    }\r\n  });\r\n  return max;\r\n};\r\n\r\nmodule.exports = maxBy;\r\n\r\n/***/ })\r\n/******/ ]);\r\n});\r\n//# sourceMappingURL=adjust.js.map"]}